<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[畑鹿驚 - 博客]]></title>
  <link href="http://lawlietfans.coding.me/atom.xml" rel="self"/>
  <link href="http://lawlietfans.coding.me/"/>
  <updated>2017-01-15T16:59:37+08:00</updated>
  <id>http://lawlietfans.coding.me/</id>
  <author>
    <name><![CDATA[lawlietfans]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[如何通过fpmmm和zabbix来监控客户机上MariaDB数据库运行情况]]></title>
    <link href="http://lawlietfans.coding.me/blog/2017/01/15/howto-use-fpmmm-and-zabbix-monitoring-database-state/"/>
    <updated>2017-01-15T21:00:00+08:00</updated>
    <id>http://lawlietfans.coding.me/blog/2017/01/15/howto-use-fpmmm-and-zabbix-monitoring-database-state</id>
    <content type="html"><![CDATA[<p>本文介绍如何通过fpmmm和zabbix来监控客户机上MariaDB数据库运行情况。</p>

<!--more-->


<p>首先在客户机安装MariaDB和zabbix，参考<a href="http://www.cnblogs.com/lawlietfans/p/6287192.html#%E5%AE%89%E8%A3%85zabbix">上一篇</a></p>

<p>安装fpmmm的过程主要参考[1]。</p>

<ul>
<li>安装fpmmm的依赖</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; yum install php-cli php-process php-mysqli
</span><span class='line'>shell&gt; cat <span class="s">&lt;&lt; _EOF &gt;/etc/php.d/fpmmm.ini</span>
</span><span class='line'><span class="s">variables_order = &quot;EGPCS&quot;</span>
</span><span class='line'><span class="s">date.timezone = &#39;Asia/Shanghai&#39;</span>
</span><span class='line'><span class="s">_EOF</span>
</span><span class='line'>
</span><span class='line'>shell&gt; rpm -Uvh http://repo.zabbix.com/zabbix/2.2/rhel/7/x86_64/zabbix-release-2.2-1.el7.noarch.rpm
</span><span class='line'>shell&gt; yum update
</span><span class='line'>shell&gt; yum install zabbix-sender
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="http://www.fromdual.com/download-performance-monitor">下载</a>并安装fpmmm0.10.5</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nb">cd</span> /opt
</span><span class='line'>tar xf /tmp/fpmmm-0.10.5.tar.gz
</span><span class='line'>ln -s fpmmm-0.10.5 fpmmm
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>config</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>mkdir /etc/fpmmm
</span><span class='line'>cp /opt/fpmmm/tpl/fpmmm.conf.template /etc/fpmmm/fpmmm.conf
</span><span class='line'>chown -R zabbix: /etc/fpmmm
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>vim <code>/etc/fpmmm/fpmmm.conf</code></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="c"># This MUST match Hostname in Zabbix!</span>
</span><span class='line'><span class="o">[</span>machine01<span class="o">]</span>
</span><span class='line'>xxx
</span><span class='line'>
</span><span class='line'><span class="c"># Here you could add a random name of your MySQL/MariaDB instance</span>
</span><span class='line'><span class="o">[</span>mysqld01<span class="o">]</span>          <span class="c"># This MUST match Hostname in Zabbix!</span>
</span><span class='line'>xxx
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>create monitoring user(中创建监控的mysql的用户fpmmm)</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; create user <span class="s1">&#39;fpmmm&#39;</span>@<span class="s1">&#39;127.0.0.1&#39;</span> identified by <span class="s1">&#39;your_password&#39;</span><span class="p">;</span>
</span><span class='line'>MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; grant process on *.* to <span class="s1">&#39;fpmmm&#39;</span>@<span class="s1">&#39;127.0.0.1&#39;</span><span class="p">;</span>
</span><span class='line'>MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; grant replication client on *.* to <span class="s1">&#39;fpmmm&#39;</span>@<span class="s1">&#39;127.0.0.1&#39;</span><span class="p">;</span>
</span><span class='line'>MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; grant <span class="k">select</span> on mysql.user to <span class="s1">&#39;fpmmm&#39;</span>@<span class="s1">&#39;127.0.0.1&#39;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>此时，最好增加replication slave权限</p>

<p><code>GRANT REPLICATION SLAVE ON *.* TO 'user_fpmmm'@'127.0.0.1';</code></p>

<p>这一条官网没有，不过不加的话会在log里面提醒你需要，主要为了show slave hosts。[3]</p>

<ul>
<li>Adding the zabbix user to the mysql group</li>
</ul>


<p><code>usermod -G mysql zabbix</code></p>

<ul>
<li>test fpmmm.conf并查看log</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>/opt/fpmmm/bin/fpmmm --config<span class="o">=</span>/etc/fpmmm/fpmmm.conf
</span><span class='line'>1
</span><span class='line'><span class="nv">$ </span>cat /tmp/fpmmm/fpmmm.log
</span><span class='line'>24634:2016-12-06 16:07:35.296 - ERR :     Cannot <span class="nb">read </span>PID file /var/run/mysqld/mysqld.pid <span class="o">(</span><span class="nv">rc</span><span class="o">=</span>1476<span class="o">)</span>.
</span><span class='line'>24634:2016-12-06 16:07:35.296 - ERR :     Either file does not exist or I have no <span class="nb">read </span>permissions.
</span><span class='line'>24634:2016-12-06 16:07:35.296 - ERR :     Are you sure the process is running?
</span><span class='line'>24634:2016-12-06 16:07:35.296 - ERR :     Adding the zabbix user to the mysql group might help...
</span><span class='line'>24634:2016-12-06 16:07:35.296 - ERR :     Module FromDualMySQLprocess got an error <span class="o">(</span><span class="nv">rc</span><span class="o">=</span>1476<span class="o">)</span>.
</span><span class='line'>24634:2016-12-06 16:07:35.414 - WARN:     Binary Log is disabled. Module <span class="s1">&#39;master&#39;</span> does not make sense <span class="k">for</span> host mysqld... <span class="o">(</span><span class="nv">rc</span><span class="o">=</span>1308<span class="o">)</span>.
</span><span class='line'>24634:2016-12-06 16:07:35.443 - WARN:     Instance mysqld seems not to be a Slave. <span class="o">(</span><span class="nv">rc</span><span class="o">=</span>1577<span class="o">)</span>.
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>去除ERR

<ul>
<li>修改pid路径: <code>PidFile = /var/lib/mysql/localhost.pid</code></li>
<li><a href="http://www.cnblogs.com/xiaoheike/p/5873274.html">打开bin log</a></li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; vim /etc/my.cnf
</span><span class='line'><span class="o">[</span>client<span class="o">]</span>
</span><span class='line'>...
</span><span class='line'>
</span><span class='line'><span class="o">[</span>mysqld<span class="o">]</span>
</span><span class='line'>...
</span><span class='line'>log-bin<span class="o">=</span>mysql-bin
</span><span class='line'>
</span><span class='line'>MariaDB <span class="o">[(</span>none<span class="o">)]</span>&gt; show variables like <span class="s1">&#39;log_bin%&#39;</span><span class="p">;</span>
</span><span class='line'>+---------------------------------+--------------------------------+
</span><span class='line'><span class="p">|</span> Variable_name                   <span class="p">|</span> Value                          <span class="p">|</span>
</span><span class='line'>+---------------------------------+--------------------------------+
</span><span class='line'><span class="p">|</span> log_bin                         <span class="p">|</span> ON                             <span class="p">|</span>
</span><span class='line'><span class="p">|</span> log_bin_basename                <span class="p">|</span> /var/lib/mysql/mysql-bin       <span class="p">|</span>
</span><span class='line'><span class="p">|</span> log_bin_index                   <span class="p">|</span> /var/lib/mysql/mysql-bin.index <span class="p">|</span>
</span><span class='line'><span class="p">|</span> log_bin_trust_function_creators <span class="p">|</span> OFF                            <span class="p">|</span>
</span><span class='line'>+---------------------------------+--------------------------------+
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>最后再次test fpmmm.conf</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'><span class="nv">$ </span>/opt/fpmmm/bin/fpmmm --config<span class="o">=</span>/etc/fpmmm/fpmmm.conf
</span><span class='line'>1
</span><span class='line'><span class="nv">$ </span>cat /tmp/fpmmm/fpmmm.log
</span><span class='line'>
</span><span class='line'>//如果有意外情况，试着以root身份运行该命令
</span><span class='line'><span class="nv">$ </span>sudo -u root /opt/fpmmm/bin/fpmmm --config<span class="o">=</span>/etc/fpmmm/fpmmm.conf
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>运行</li>
</ul>


<p>测试没问题后，修改zabbix的agent配置文件[2]</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; vim /etc/zabbix/zabbix_agentd.conf
</span><span class='line'><span class="nv">UserParameter</span><span class="o">=</span>FromDual.MySQL.check,/opt/fpmmm/bin/fpmmm --config<span class="o">=</span>/etc/fpmmm/fpmmm.conf
</span><span class='line'>shell&gt; systemctl restart zabbix-agent
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>把fpmmm自带的模版导入到zabbix中</li>
</ul>


<p>tpl文件的具体作用[4]</p>

<p>Template_FromDual.MySQL.mpm.xml (监控mpm agent本身,这个必须导入)<br/>
Template_FromDual.MySQL.server.xml (监控Linux系统跟数据库使用相关的附加项)<br/>
Template_FromDual.MySQL.process.xml (监控各种Linux进程[比如:mysqld,ndbd])<br/>
Template_FromDual.MySQL.mysql.xml (监控MySQL常用状态变量)<br/>
Template_FromDual.MySQL.innodb.xml (监控InnoDB存储引擎状态变量)<br/>
Template_FromDual.MySQL.myisam.xml (监控MyISAM存储引擎状态变量)<br/>
Template_FromDual.MySQL.master.xml (监控MySQL主从复制的Master状态)<br/>
Template_FromDual.MySQL.slave.xml (监控MySQL主从复制的Slave状态)</p>

<p>MPM其它用途的模板:<br/>
Template_FromDual.MySQL.ndb.xml (监控MySQL Cluster)<br/>
Template_FromDual.MySQL.galera.xml (监控MySQL Galera Cluster)<br/>
Template_FromDual.MySQL.pbxt.xml (监控PBXT存储引擎状态变量)<br/>
Template_FromDual.MySQL.aria.xml (监控Aria存储引擎的状态变量)<br/>
Template_FromDual.MySQL.drbd.xml (监控DRBD设备状态信息</p>

<ul>
<li>在zabbix管理界面创建两个host</li>
</ul>


<p>其中一个监控机器(one for the machine): 导入fpmmm和server这两个模版</p>

<p>另一个监控数据库(and one for the database): 导入其他templates</p>

<p>注意Agent interface为当前agent的ip地址。</p>

<ul>
<li>定时运行fpmmm agent</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; <span class="nb">echo</span> <span class="s2">&quot;UserParameter=FromDual.MySQL.check,/opt/fpmmm/bin/fpmmm --config=/etc/fpmmm/fpmmm.conf&quot;</span> &gt; /etc/zabbix/zabbix_agentd.d/fpmmm.conf
</span></code></pre></td></tr></table></div></figure>


<p>注意上面的命令不能实现定时运行，要用用crontab实现。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; vim /etc/crontab
</span><span class='line'>* * * * * root <span class="nb">echo</span> <span class="s2">&quot;&quot;</span> &gt;&gt; /tmp/fpmmm/fpmmm.log <span class="p">&amp;</span> /opt/fpmmm/bin/fpmmm --config<span class="o">=</span>/etc/fpmmm/fpmmm.conf &gt;/dev/null
</span><span class='line'>shell&gt; tail /tmp/fpmmm/fpmmm.log
</span><span class='line'>
</span><span class='line'>67721:2016-12-14 15:39:01.293 - INFO: FromDual Performance Monitor <span class="k">for</span> MySQL and MariaDB <span class="o">(</span>fpmmm<span class="o">)</span> <span class="o">(</span>0.10.5<span class="o">)</span> run started.
</span><span class='line'>67721:2016-12-14 15:39:02.587 - INFO: FromDual Performance Monitor <span class="k">for</span> MySQL and MariaDB <span class="o">(</span>fpmmm<span class="o">)</span> run finished <span class="o">(</span><span class="nv">rc</span><span class="o">=</span>0<span class="o">)</span>.
</span><span class='line'>
</span><span class='line'>68008:2016-12-14 15:40:01.650 - INFO: FromDual Performance Monitor <span class="k">for</span> MySQL and MariaDB <span class="o">(</span>fpmmm<span class="o">)</span> <span class="o">(</span>0.10.5<span class="o">)</span> run started.
</span><span class='line'>68008:2016-12-14 15:40:02.944 - INFO: FromDual Performance Monitor <span class="k">for</span> MySQL and MariaDB <span class="o">(</span>fpmmm<span class="o">)</span> run finished <span class="o">(</span><span class="nv">rc</span><span class="o">=</span>0<span class="o">)</span>.
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>不使用fpmmm如何监控数据库运行状态？</li>
</ul>


<p>see also <a href="http://www.yuminstall.com/zabbix-monitoring-mysql.html">使用zabbix2.2自带的mysql template，设置并查看mysql监控情况</a></p>

<h1>References</h1>

<ol>
<li><a href="http://www.fromdual.com/fpmmm-installation-guide">FPMMM INSTALLATION GUIDE</a></li>
<li><a href="http://ixhao.blog.51cto.com/11988319/1847221">Zabbix配合fpmmm(mpm)实现对Mysql的全面监控</a></li>
<li><a href="http://www.cnblogs.com/zejin2008/p/5416441.html">http://www.cnblogs.com/zejin2008/p/5416441.html</a></li>
<li><a href="http://www.linuxea.com/1304.html">Zabbix+Mysql Fpmmm（MPM）监控</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Zabbix概念、安装以及快速入门]]></title>
    <link href="http://lawlietfans.coding.me/blog/2017/01/15/zabbix-quick-start/"/>
    <updated>2017-01-15T20:00:00+08:00</updated>
    <id>http://lawlietfans.coding.me/blog/2017/01/15/zabbix-quick-start</id>
    <content type="html"><![CDATA[<p>Zabbix is an enterprise-class open source distributed monitoring solution.[1]</p>

<p>Zabbix是一个企业级的、开源的、分布式的监控套件</p>

<ul>
<li>Zabbix可以监控网络和服务的监控状况.</li>
<li>Zabbix利用灵活的告警机制，允许用户对事件发送基于Email的告警. 这样可以保证快速的对问题作出相应.</li>
<li>Zabbix是零成本的. 因为Zabbix编写和发布基于GPL V2协议. 意味着源代码是免费发布的.</li>
</ul>


<!--more-->


<p>Zabbix特性如下[2]：</p>

<ol>
<li>数据收集</li>
<li>灵活的阀值定义</li>
<li>高级告警配置</li>
<li>实时绘图</li>
<li>扩展的图形化显示</li>
<li>历史数据存储</li>
<li>配置简单</li>
<li>模板使用</li>
<li>网络自动发现</li>
<li>快速的web接口</li>
<li>Zabbix API</li>
<li>权限系统</li>
<li>全特性、agent易扩展</li>
<li>二进制守护进程</li>
<li>具备应对复杂环境情况</li>
</ol>


<p>可以总结为如下三个特点</p>

<p>1）灵活的通知机制：allows users to configure e-mail based alerts for virtually any event；</p>

<p>2）数据可视化；</p>

<p>3）所有报告、统计、参数配置都可通过web端完成；</p>

<p>所以zabbix很适合服务器集群管理员进行功能规划(capacity planning)</p>

<h1>1 概览</h1>

<ul>
<li>架构

<ul>
<li>Server</li>
<li>database storage</li>
<li>web interface</li>
<li>proxy</li>
<li>agent</li>
</ul>
</li>
<li>数据流(data flow)</li>
</ul>


<p><img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115155021369-2100463231.png" alt="arch" /></p>

<p>其中，Zabbix Server为中心组件，用来获取agent存活状况及监控数据和统计. 所有的配置、统计、操作数据均通过Server进行存取.</p>

<p>Zabbix agent部署在被监控机器上用来监控本地资源和应用（如硬盘、内存、处理器统计等）</p>

<h1>2 术语概念</h1>

<h2>2.1 server / client / proxy</h2>

<p>Zabbix server的功能可以分为三部分：server、web前端和database。</p>

<p>Server执行polling和trapping来采集数据，评估是否触发触发器，发送报警给用户</p>

<p>agent向其报告有效数据和统计。</p>

<p>database存储所有configuration, statistical and operational data。</p>

<p>server和web前端都与database进行交互。</p>

<p>Zabbix server以守护(daemon)进程方式运行</p>

<h2>2.2 命令行工具</h2>

<p>Sender / Get</p>

<h1>3 zabbix进程构成 [3]</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="err">默认情况下</span><span class="n">zabbix</span><span class="err">包含</span><span class="mi">5</span><span class="err">个程序：</span>
</span><span class='line'><span class="n">zabbix_agentd</span><span class="err">、</span><span class="n">zabbix_get</span><span class="err">、</span><span class="n">zabbix_proxy</span><span class="err">、</span><span class="n">zabbix_sender</span><span class="err">、</span><span class="n">zabbix_server</span><span class="err">，另外一个</span><span class="n">zabbix_java_gateway</span><span class="err">是可选</span>
</span><span class='line'>
</span><span class='line'><span class="n">zabbix_agentd</span>
</span><span class='line'><span class="err">客户端守护进程，此进程收集客户端数据，例如</span><span class="n">cpu</span><span class="err">负载、内存、硬盘使用情况等</span>
</span><span class='line'>
</span><span class='line'><span class="n">zabbix_get</span>
</span><span class='line'><span class="n">zabbix</span><span class="err">工具，单独使用的命令，通常在</span><span class="n">server</span><span class="err">或者</span><span class="n">proxy</span><span class="err">端执行获取远程客户端信息的命令。</span>
</span><span class='line'><span class="err">通常用户排错。例如在</span><span class="n">server</span><span class="err">端获取不到客户端的内存数据，我们可以使用</span><span class="n">zabbix_get</span><span class="err">获取客户端的内容的方式来做故障排查。</span>
</span><span class='line'>
</span><span class='line'><span class="n">zabbix_sender</span>
</span><span class='line'><span class="n">zabbix</span><span class="err">工具，用于发送数据给</span><span class="n">server</span><span class="err">或者</span><span class="n">proxy</span><span class="err">，通常用于耗时比较长的检查。</span>
</span><span class='line'><span class="err">很多检查非常耗时间，导致</span><span class="n">zabbix</span><span class="err">超时。于是我们在脚本执行完毕之后，使用</span><span class="n">sender</span><span class="err">主动提交数据。</span>
</span><span class='line'>
</span><span class='line'><span class="n">zabbix_server</span>
</span><span class='line'><span class="n">zabbix</span><span class="err">服务端守护进程。</span>
</span><span class='line'><span class="n">zabbix_agentd</span><span class="err">、</span><span class="n">zabbix_get</span><span class="err">、</span><span class="n">zabbix_sender</span><span class="err">、</span><span class="n">zabbix_proxy</span><span class="err">、</span><span class="n">zabbix_java_gateway</span><span class="err">的数据最终都是提交到</span><span class="n">server</span>
</span><span class='line'><span class="err">备注：当然不是数据都是主动提交给</span><span class="n">zabbix_server</span><span class="p">,</span><span class="err">也有的是</span><span class="n">server</span><span class="err">主动去取数据。</span>
</span><span class='line'>
</span><span class='line'><span class="n">zabbix_proxy</span>
</span><span class='line'><span class="n">zabbix</span><span class="err">代理守护进程。功能类似</span><span class="n">server</span><span class="err">，</span>
</span><span class='line'><span class="err">唯一不同的是它只是一个中转站，它需要把收集到的数据提交</span><span class="o">/</span><span class="err">被提交到</span><span class="n">server</span><span class="err">里。</span>
</span><span class='line'>
</span><span class='line'><span class="n">zabbix_java_gateway</span>
</span><span class='line'><span class="n">zabbix2</span><span class="mf">.0</span><span class="err">之后引入的一个功能。顾名思义：</span><span class="n">Java</span><span class="err">网关，类似</span><span class="n">agentd</span><span class="err">，但是只用于</span><span class="n">Java</span><span class="err">方面。</span>
</span><span class='line'><span class="err">需要特别注意的是，它只能主动去获取数据，而不能被动获取数据。它的数据最终会给到</span><span class="n">server</span><span class="err">或者</span><span class="n">proxy</span><span class="err">。</span>
</span></code></pre></td></tr></table></div></figure>


<h1>4 安装zabbix</h1>

<p>首先安装MariaDB数据库。Linux发行版，使用<a href="https://downloads.mariadb.org/mariadb/repositories/">repository configuration tool</a>，选择自己合适的安装步骤。</p>

<ul>
<li>卸载mysql</li>
</ul>


<p>如果已经安装了mysql，需要先卸载mysql，否则安装过程中会出现冲突。</p>

<ul>
<li>本机选择10.1stable for centos7 x86_64</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>//添加源
</span><span class='line'>shell&gt; cat /etc/yum.repos.d/mariaDB.repo
</span><span class='line'><span class="o">[</span>mariadb<span class="o">]</span>
</span><span class='line'><span class="nv">name</span> <span class="o">=</span> MariaDB
</span><span class='line'><span class="nv">baseurl</span> <span class="o">=</span> http://yum.mariadb.org/10.1/centos7-amd64
</span><span class='line'><span class="nv">gpgkey</span><span class="o">=</span>https://yum.mariadb.org/RPM-GPG-KEY-MariaDB
</span><span class='line'><span class="nv">gpgcheck</span><span class="o">=</span>1
</span><span class='line'>
</span><span class='line'>shell&gt; yum install MariaDB-server MariaDB-client mariadb
</span><span class='line'>
</span><span class='line'>//服务管理，使用如下命令start/stop MariaDB:
</span><span class='line'>shell&gt; sudo systemctl start mariadb.service <span class="c">#直接用mariadb也行</span>
</span><span class='line'>shell&gt; sudo systemctl stop mariadb.service
</span><span class='line'>shell&gt; sudo systemctl <span class="nb">enable </span>mariadb.service <span class="c">#开机自启动</span>
</span></code></pre></td></tr></table></div></figure>


<p>从10.1起，Galera Cluster(同步MariaDB数据库的多master集群的工具)默认包含在MariaDB中。</p>

<p>see also <a href="https://mariadb.com/kb/en/mariadb/yum/">Installing MariaDB with yum</a>.</p>

<h2>4.1 zabbix sever [4]</h2>

<p>安装</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; rpm -ivh http://repo.zabbix.com/zabbix/2.2/rhel/7/x86_64/zabbix-release-2.2-1.el7.noarch.rpm
</span><span class='line'>//for Zabbix server and web frontend with mysql database
</span><span class='line'>shell&gt; yum install zabbix-server-mysql zabbix-web-mysql
</span><span class='line'>//可以将server与agent安装在同一台机器
</span><span class='line'>shell&gt; yum install zabbix-agent
</span></code></pre></td></tr></table></div></figure>


<p>创建zabbix数据库以及远程用户</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">user</span><span class="err">@</span><span class="n">host</span> <span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="n">mysql</span> <span class="o">-</span><span class="n">uroot</span> <span class="o">-</span><span class="n">p</span>
</span><span class='line'>
</span><span class='line'><span class="n">MariaDB</span> <span class="p">[(</span><span class="n">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">create</span> <span class="n">database</span> <span class="n">zabbix</span> <span class="n">character</span> <span class="n">set</span> <span class="n">utf8</span> <span class="n">collate</span> <span class="n">utf8_bin</span><span class="p">;</span>
</span><span class='line'><span class="n">MariaDB</span> <span class="p">[(</span><span class="n">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">grant</span> <span class="n">all</span> <span class="n">privileges</span> <span class="n">on</span> <span class="n">zabbix</span><span class="p">.</span><span class="o">*</span> <span class="n">to</span> <span class="n">zabbix</span><span class="err">@</span><span class="n">localhost</span> <span class="n">identified</span> <span class="n">by</span> <span class="err">&#39;</span><span class="n">your_password</span><span class="err">&#39;</span><span class="p">;</span>
</span><span class='line'><span class="n">MariaDB</span> <span class="p">[(</span><span class="n">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">grant</span> <span class="n">all</span> <span class="n">privileges</span> <span class="n">on</span> <span class="n">zabbix</span><span class="p">.</span><span class="o">*</span> <span class="n">to</span> <span class="n">zabbix</span><span class="err">@&#39;</span><span class="mf">172.16</span><span class="p">.</span><span class="o">%</span><span class="p">.</span><span class="o">%</span><span class="err">&#39;</span> <span class="n">identified</span> <span class="n">by</span> <span class="err">&#39;</span><span class="n">your_password</span><span class="err">&#39;</span><span class="p">;</span>
</span><span class='line'><span class="n">MariaDB</span> <span class="p">[(</span><span class="n">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">flush</span> <span class="n">privileges</span><span class="p">;</span>
</span><span class='line'><span class="n">MariaDB</span> <span class="p">[(</span><span class="n">none</span><span class="p">)]</span><span class="o">&gt;</span> <span class="n">select</span> <span class="n">host</span><span class="p">,</span><span class="n">user</span> <span class="n">from</span> <span class="n">mysql</span><span class="p">.</span><span class="n">user</span><span class="p">;</span>
</span><span class='line'><span class="o">+-----------------------+--------+</span>
</span><span class='line'><span class="o">|</span> <span class="n">host</span>                  <span class="o">|</span> <span class="n">user</span>   <span class="o">|</span>
</span><span class='line'><span class="o">+-----------------------+--------+</span>
</span><span class='line'><span class="o">|</span> <span class="mf">127.0.0.1</span>             <span class="o">|</span> <span class="n">root</span>   <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="mf">172.16</span><span class="p">.</span><span class="o">%</span><span class="p">.</span><span class="o">%</span>            <span class="o">|</span> <span class="n">zabbix</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="o">::</span><span class="mi">1</span>                   <span class="o">|</span> <span class="n">root</span>   <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="n">localhost</span>             <span class="o">|</span>        <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="n">localhost</span>             <span class="o">|</span> <span class="n">fsj</span>    <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="n">localhost</span>             <span class="o">|</span> <span class="n">root</span>   <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="n">localhost</span>             <span class="o">|</span> <span class="n">zabbix</span> <span class="o">|</span>
</span><span class='line'><span class="o">|</span> <span class="n">localhost</span><span class="p">.</span><span class="n">localdomain</span> <span class="o">|</span>        <span class="o">|</span>
</span><span class='line'><span class="o">+-----------------------+--------+</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>导入初始化schema和data</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; <span class="nb">cd</span> /usr/share/doc/zabbix-server-mysql-2.2.15/create
</span><span class='line'>shell&gt; mysql -uroot -p  zabbix &lt; schema.sql
</span><span class='line'>shell&gt; mysql -uroot -p  zabbix &lt; images.sql
</span><span class='line'>shell&gt; mysql -uroot -p  zabbix &lt; data.sql
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Edit database configuration in zabbix_server.conf</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; vi /etc/zabbix/zabbix_server.conf
</span><span class='line'><span class="nv">DBHost</span><span class="o">=</span>localhost
</span><span class='line'><span class="nv">DBName</span><span class="o">=</span>zabbix
</span><span class='line'><span class="nv">DBUser</span><span class="o">=</span>zabbix
</span><span class='line'><span class="nv">DBPassword</span><span class="o">=</span>zabbix
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>开启zabbix-server服务：systemctl start zabbix-server</p></li>
<li><p>Editing PHP configuration for Zabbix frontend</p>

<ul>
<li>修改timezone：<code>php_value date.timezone Asia/Shanghai</code></li>
<li>重启httpd服务：service httpd restart</li>
</ul>
</li>
</ul>


<p>或者通过sed调整php配置[6]</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; sed -i <span class="s1">&#39;s/^.*date.timezone =.*$/date.timezone = Asia\/Shanghai/g&#39;</span> /etc/php.ini
</span><span class='line'>shell&gt; sed -i <span class="s1">&#39;s/^.*post_max_size =.*$/post_max_size = 16M/g&#39;</span> /etc/php.ini
</span><span class='line'>shell&gt; sed -i <span class="s1">&#39;s/^.*max_execution_time =.*$/max_execution_time = 300/g&#39;</span> /etc/php.ini
</span><span class='line'>shell&gt; sed -i <span class="s1">&#39;s/^.*max_input_time =.*$/max_input_time = 300/g&#39;</span> /etc/php.ini
</span><span class='line'>shell&gt; sed -i <span class="s1">&#39;s/^.* memory_limit =.*$/memory_limit = 128M/g&#39;</span>  /etc/php.ini
</span><span class='line'>shell&gt; service httpd restart
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>配置服务开机启动</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; chkconfig zabbix-server on
</span><span class='line'>shell&gt; chkconfig zabbix-agent on
</span><span class='line'>shell&gt; chkconfig httpd on
</span></code></pre></td></tr></table></div></figure>


<p>访问 <a href="http://your-zabbix-server-ip/zabbix">http://your-zabbix-server-ip/zabbix</a></p>

<p>默认username/password 是Admin/zabbix.</p>

<ul>
<li>如果出现错误：zabbix server is not running</li>
</ul>


<p><a href="https://my.oschina.net/u/1590519/blog/330357">解决办法</a>：设置SELinux 成为permissive模式  <code>shell&gt; setenforce 0</code></p>

<ul>
<li>如果出现防火墙相关问题，打开agent的端口</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>查看zabbix监听端口：
</span><span class='line'>shell&gt; netstat -nlop <span class="p">|</span> grep zabbix
</span><span class='line'>tcp        <span class="m">0</span>      <span class="m">0</span> 0.0.0.0:10051           0.0.0.0:*               LISTEN      23904/zabbix_server  off <span class="o">(</span>0.00/0/0<span class="o">)</span>
</span><span class='line'>tcp6       <span class="m">0</span>      <span class="m">0</span> :::10051                :::*                    LISTEN      23904/zabbix_server  off <span class="o">(</span>0.00/0/0<span class="o">)</span>
</span><span class='line'>打开防火墙该端口：
</span><span class='line'>shell&gt; iptables -I INPUT -p tcp --dport <span class="m">10051</span> -m state --state NEW,ESTABLISHED -j ACCEPT
</span><span class='line'>shell&gt; iptables -I OUTPUT -p tcp --sport <span class="m">10051</span> -m state --state ESTABLISHED -j ACCEPT
</span></code></pre></td></tr></table></div></figure>


<p>也可以批量修改其他端口：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; iptables-save &gt; firewalls.txt
</span><span class='line'>shell&gt; vim firewalls.txt
</span><span class='line'>shell&gt; iptables-restore &lt;firewalls.txt
</span></code></pre></td></tr></table></div></figure>


<p>或者直接关闭防火墙：<code># systemctl stop firewalld</code></p>

<p>see also <a href="http://www.cnblogs.com/pixy/p/5156739.html">Linux防火墙配置(iptables, firewalld)</a></p>

<h2>4.2 zabbix agent</h2>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>shell&gt; sudo rpm -ivh http://repo.zabbix.com/zabbix/2.2/rhel/7/x86_64/zabbix-release-2.2-1.el7.noarch.rpm
</span><span class='line'>shell&gt; sudo yum install zabbix-agent zabbix-sender -y
</span><span class='line'>shell&gt; grep -Ev <span class="s1">&#39;(^$|^#)&#39;</span> /etc/zabbix/zabbix_agentd.conf  <span class="c">#修改server地址</span>
</span><span class='line'><span class="nv">PidFile</span><span class="o">=</span>/var/run/zabbix/zabbix_agentd.pid
</span><span class='line'><span class="nv">LogFile</span><span class="o">=</span>/var/log/zabbix/zabbix_agentd.log
</span><span class='line'><span class="nv">LogFileSize</span><span class="o">=</span>0
</span><span class='line'><span class="nv">Server</span><span class="o">=</span>172.16.44.5
</span><span class='line'><span class="nv">Hostname</span><span class="o">=</span>Zabbix server fsj
</span><span class='line'><span class="nv">Include</span><span class="o">=</span>/etc/zabbix/zabbix_agentd.d/
</span><span class='line'>
</span><span class='line'>shell&gt; sudo service zabbix-agent start
</span><span class='line'>shell&gt; sudo systemctl <span class="nb">enable </span>zabbix-agent
</span></code></pre></td></tr></table></div></figure>


<h1>5 用户管理</h1>

<p><img src="http://ww1.sinaimg.cn/large/7156462egw1fb0n5yw928j218e0e0jzk.jpg" alt="user list" /></p>

<p><img src="http://ww1.sinaimg.cn/large/7156462egw1fb0njs2v9ij218g0cf7b0.jpg" alt="user groups list" /></p>

<p>权限管理并不是直接设置一个user对应于一个host的什么权限，而是设置user groups对应与host groups的权限。</p>

<p><img src="http://ww3.sinaimg.cn/large/7156462egw1fb0nmppfp0j20vy0futd2.jpg" alt="" /></p>

<p>切换到permissions选项卡</p>

<p><img src="http://ww4.sinaimg.cn/large/7156462egw1fb0nnyipqzj20zh0ohgq8.jpg" alt="" /></p>

<h1>6 开始监控</h1>

<h2>6.1 添加Zabbix agent（局域网其他机器）以及其item</h2>

<p>新建host
<img src="https://www.zabbix.com/documentation/2.2/_media/manual/quickstart/new_host.png" alt="new host" /></p>

<p>其中，最好有一个Host name项和<code>/etc/zabbix/zabbix_agentd.conf</code>中Hostname保持一致。</p>

<p>如果不存在host与配置文件中的Hostname相同，那么运行之后log文件会报错<code>host xxx(Hostname值) not found</code>，但是前端host条目依然可以获取到数据。</p>

<p>修改conf文件后要重启服务才能生效</p>

<p>新建item
<img src="https://www.zabbix.com/documentation/2.2/_media/manual/quickstart/new_item.png" alt="new item" /></p>

<p>其中key表示要监测的的信息。
1. 详细：<a href="https://www.zabbix.com/documentation/2.2/manual/config/items/itemtypes/zabbix_agent">https://www.zabbix.com/documentation/2.2/manual/config/items/itemtypes/zabbix_agent</a>
2. <a href="https://www.zabbix.com/documentation/2.2/manual/appendix/items/supported_by_platform">Items supported by platform</a></p>

<p>在configuration->hosts页面可看到刚刚添加的host，如果available项为绿色Z表示一切正常。</p>

<p><img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115155508338-57307903.png" alt="host list" /></p>

<p>有可能出现如下错误</p>

<blockquote><p>Received empty response from Zabbix Agent at [x.x.x.x]. Assuming that agent dropped connection because of access permission</p></blockquote>

<p>到Monitoring -> Latest data页面查看监控到的实时数据</p>

<p><img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115155638994-755881875.png" alt="latest data" /></p>

<p>点击graph可以查看cpu load的折线图。</p>

<h2>6.2 触发器</h2>

<p>一个触发器包括一个定义了数据阈值的<a href="https://www.zabbix.com/documentation/2.2/manual/config/triggers/expression">表达式</a>。</p>

<p>格式为<code>{&lt;server&gt;:&lt;key&gt;.&lt;function&gt;(&lt;parameter&gt;)}&lt;operator&gt;&lt;constant&gt;</code>。<br/>
其中：
1. key: 该server定义的item
2. function: <a href="https://www.zabbix.com/documentation/2.2/manual/appendix/triggers/functions">https://www.zabbix.com/documentation/2.2/manual/appendix/triggers/functions</a>
3. parameter: 数字n表示n秒，#n表示最近n个值，n[m|h|d]表示n[分钟|小时|天]</p>

<p>输入数据如果高于该阈值，触发器就会报警。</p>

<h3>6.2.1 创建触发器</h3>

<p><img src="https://www.zabbix.com/documentation/2.2/_media/manual/quickstart/new_trigger.png" alt="new trigger" /></p>

<p>激活触发器 <code>shell&gt; cat /dev/urandom | md5sum</code></p>

<p><img src="http://ww4.sinaimg.cn/large/7156462egw1fazje03tolj217q0itgs1.jpg" alt="latest data graph of cpu load" /></p>

<p><img src="http://ww4.sinaimg.cn/large/7156462egw1fazjga5c24j218b0iegsq.jpg" alt="monitoring-triggers" /></p>

<p>更多触发器示例：</p>

<ol>
<li><code>{www.zabbix.com:system.cpu.load[all,avg1].last()}&gt;5</code></li>
<li><code>{www.zabbix.com:system.cpu.load[all,avg1].last()}&gt;5|{www.zabbix.com:system.cpu.load[all,avg1].min(10m)}&gt;2</code></li>
<li><code>{www.zabbix.com:vfs.file.cksum[/etc/passwd].diff()}=1</code></li>
</ol>


<h3>6.2.2 通知</h3>

<p>Administration -> Media type 设置 email（需要有email软件支持）</p>

<p><img src="https://www.zabbix.com/documentation/2.2/_media/manual/quickstart/1.9.7_media_type_email.png" alt="" /></p>

<p>新建action</p>

<p><img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115155906385-1184761700.png" alt="" /></p>

<p>查看发送情况</p>

<p><img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115160022431-741622625.png" alt="administration audit" /></p>

<p>这里没有设email相关，所以发送失败</p>

<h1>7 使用模版</h1>

<p>点击host，切换到templates选项卡可以关联想要的模版。</p>

<p><img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115160241322-10249453.png" alt="" /></p>

<p>我们也可以通过 Configuration → Templates 可以创建空模版。然后把现有的item、trigger等拷贝到该模版，方便以后批量应用。
<img src="http://images2015.cnblogs.com/blog/631533/201701/631533-20170115160503838-460061465.png" alt="" /></p>

<h1>References</h1>

<ol>
<li><a href="https://www.zabbix.com/documentation/2.2/manual">https://www.zabbix.com/documentation/2.2/manual</a></li>
<li><a href="http://zabbix-manual-in-chinese.readthedocs.io/en/latest/index.html">http://zabbix-manual-in-chinese.readthedocs.io/en/latest/index.html</a></li>
<li><a href="http://www.ttlsa.com/zabbix/zabbix-section-3-of-chapter-1/">http://www.ttlsa.com/zabbix/zabbix-section-3-of-chapter-1/</a></li>
<li><a href="https://www.zabbix.com/documentation/2.2/manual/quickstart">https://www.zabbix.com/documentation/2.2/manual/quickstart</a></li>
<li><a href="http://www.ttlsa.com/zabbix/follow-ttlsa-to-study-zabbix/">跟着ttlsa一起学zabbix监控</a></li>
<li><a href="http://www.cnblogs.com/Brandyn/p/5443491.html">监控 Zabbix</a></li>
<li><a href="http://zabbix.org.cn">http://zabbix.org.cn</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Sublime Text3下快速搭建开发环境]]></title>
    <link href="http://lawlietfans.coding.me/blog/2016/12/27/how-to-setup-ST3-dev-env/"/>
    <updated>2016-12-27T20:00:00+08:00</updated>
    <id>http://lawlietfans.coding.me/blog/2016/12/27/how-to-setup-ST3-dev-env</id>
    <content type="html"><![CDATA[<p>原文链接：<a href="http://www.cnblogs.com/lawlietfans/p/6224824.html">http://www.cnblogs.com/lawlietfans/p/6224824.html</a></p>

<p>安装好<a href="http://www.sublimetext.com/3">Sublime Text3</a>之后，简单几步就可以搭建一个好用的开发环境。</p>

<p>sublime的设置包括自定义设置以及插件系统。</p>

<!-- more -->


<p>打开菜单<code>Preferences -&gt; Settings</code>，编辑自定义设置（json格式）</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='json'><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nt">&quot;caret_style&quot;</span><span class="p">:</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;theme&quot;</span><span class="p">:</span> <span class="s2">&quot;Spacegray.sublime-theme&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;color_scheme&quot;</span><span class="p">:</span> <span class="s2">&quot;Packages/Theme - Spacegray/base16-eighties.dark.tmTheme&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;ensure_newline_at_eof_on_save&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;font_face&quot;</span><span class="p">:</span> <span class="s2">&quot;YaHei Consolas Hybrid&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;font_size&quot;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;format_on_save&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;highlight_line&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;highlight_modified_tabs&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;rulers&quot;</span><span class="p">:</span>
</span><span class='line'>  <span class="p">[</span>
</span><span class='line'>      <span class="mi">80</span><span class="p">,</span>
</span><span class='line'>      <span class="mi">100</span>
</span><span class='line'>  <span class="p">],</span>
</span><span class='line'>  <span class="nt">&quot;tab_size&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;translate_tabs_to_spaces&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class='line'>  <span class="nt">&quot;update_check&quot;</span><span class="p">:</span> <span class="kc">false</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<p>我们要通过Package Control安装需要的插件，所以首先安装Package Control</p>

<p>三种方法安装Package control：</p>

<ol>
<li><code>ctrl+shift+p</code>打开命令板，输入<code>pc</code>可以看到下拉列表出现<code>install package control</code>（模糊识别关键字）</li>
<li>使用Ctrl+`快捷键或者通过View->Show Console菜单打开命令行，粘贴代码</li>
<li>手动下载<code>Package Control.sublime-package</code>并复制到Installed Packages/目录</li>
</ol>


<p>方法2、3详见<a href="http://www.cnblogs.com/luoshupeng/archive/2013/09/09/3310777.html">Sublime Text 3 安装Package Control</a></p>

<h1>1 python开发者</h1>

<p>python开发者可能需要如下插件：</p>

<ul>
<li>autosave：自动保存文件</li>
<li>AutoPEP8：按照PEP规范调整你的python代码</li>
<li>IMESupport：中文输入框跟随光标[1]</li>
<li>SublimeREPL：sublime read–eval–print loop (REPL)插件

<ul>
<li>通过菜单Tools->SublimeREPL->Python可以进入命令行环境</li>
<li><a href="https://www.zhihu.com/question/22904994">键位绑定</a></li>
</ul>
</li>
</ul>


<p>安装插件gif图演示详见[1]</p>

<h1>2 markdown编写</h1>

<p>只需要满足高亮就可以了。许多博文，包括[2]提到<a href="https://packagecontrol.io/packages/MarkdownEditing">markdown editing</a>插件，可我觉得实在是太难看了，和sublime黑色主题不搭。</p>

<p>这里强烈推荐spacegray主题。</p>

<ul>
<li><a href="https://packagecontrol.io/packages/Theme%20-%20Spacegray">theme spacegray</a>

<ul>
<li>自动高亮Markdown关键字</li>
<li>和sublime原来风格契合，可以同时使得sidebar主题也对应变化。</li>
</ul>
</li>
</ul>


<h1>References</h1>

<ol>
<li><a href="http://www.cnblogs.com/figure9/p/sublime-text-complete-guide.html">http://www.cnblogs.com/figure9/p/sublime-text-complete-guide.html</a></li>
<li><a href="http://www.cnblogs.com/jadeboy/p/5049340.html">http://www.cnblogs.com/jadeboy/p/5049340.html</a></li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux服务器配置和管理：一般管理]]></title>
    <link href="http://lawlietfans.coding.me/blog/2016/03/07/linux-foundation/"/>
    <updated>2016-03-07T20:00:00+08:00</updated>
    <id>http://lawlietfans.coding.me/blog/2016/03/07/linux-foundation</id>
    <content type="html"><![CDATA[<blockquote><p>原文地址：<a href="http://lawlietfans.coding.me/blog/2016/03/07/linux-foundation/">http://lawlietfans.coding.me/blog/2016/03/07/linux-foundation/</a></p></blockquote>

<!-- more -->


<p>OUTLINE</p>

<ul>
<li>1 Step by step</li>
<li>2 如何编辑文件？——vim编辑器入门</li>
<li>3 用户管理</li>
<li>4 文件/目录权限管理</li>
<li>5 ref</li>
</ul>


<p><a href="http://lawlietfans.coding.me/blog/2016/02/29/introduction-and-centos67-install/">上一篇</a>提到，Linux发行版就是把系统内核、附带的工具程序以及应用软件包等打包在一起，组成的一个集合体或者套件。而CentOS是其中一种发行版。
这是Linux操作系统的结构。</p>

<p><img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-26/78979443.jpg" alt="" /></p>

<p>其结构可以用kernel、shell和utility三个不同层次的同心圆来表示。其中kernel控制着系统运行的各个方面，影响着一个系统的整体性能
我们平时在Linux的使用中也大多是和shell、工具（utility）打交道。有了这些工具，程序员在shell命令行下几乎可以完成所有想做的工作，也正因为如此，Linux比Windows更加适合远程管理，因为后者的远程操作一般在GUI下完成，这无疑影响了服务器端的性能。</p>

<p>Linux下的工具是非常丰富的，任何一个程序员都可以共享自己做的小工具。如果我们想要掌握这些工具的使用。最好是系统看书比如《鸟哥的私房菜》。不想看书的话，搜到的有些资料内容比较零散，有的可能像百科一样，太过于全面[1]。这里试图从初学者用的角度来了解、演示一些常用管理工具。</p>

<h1>Step by step</h1>

<ul>
<li><p>1 xshell连上CentOS之后，如何关机重启呢？如何安装新软件？</p>

<ul>
<li><code>$ sudo shutdown -h</code> 或<code>halt</code></li>
<li>重启系统：<code>$ sudo reboot</code></li>
<li>安装git: <code>$ sudo yum install git</code></li>
</ul>
</li>
<li><p>2 查看当前目录的信息</p></li>
</ul>


<p>ls（list）命令可用来显示目录的内容。配合参 数的使用，能以不同的方式显示目录内容。[4] <br/>
格式：ls [参数]  [目录名或文件名]</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ls</span>
</span><span class='line'><span class="n">a</span>  <span class="n">b</span>  <span class="n">c</span>  <span class="n">d</span>  <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ll</span>
</span><span class='line'><span class="n">total</span> <span class="mi">0</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">a</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">b</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">c</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">d</span>
</span><span class='line'><span class="o">-</span><span class="n">rwxr</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">13</span><span class="o">:</span><span class="mi">10</span> <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ll</span> <span class="o">-</span><span class="n">a</span>
</span><span class='line'><span class="n">total</span> <span class="mi">8</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">x</span><span class="o">--</span><span class="n">x</span><span class="p">.</span> <span class="mi">2</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mi">24</span> <span class="p">.</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">3</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">17</span> <span class="mi">22</span><span class="o">:</span><span class="mo">06</span> <span class="p">..</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span>    <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">a</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span>    <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">b</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span>    <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">c</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span>    <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mo">07</span> <span class="n">d</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span>    <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">14</span><span class="o">:</span><span class="mi">24</span> <span class="p">.</span><span class="n">hiden</span>
</span><span class='line'><span class="o">-</span><span class="n">rwxr</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span>    <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">13</span><span class="o">:</span><span class="mi">10</span> <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span></code></pre></td></tr></table></div></figure>


<p>其中<code>ll</code>等价于<code>ls -l</code>.</p>

<p>查看当前路径</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">pwd</span>
</span><span class='line'><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">fsj</span><span class="o">/</span><span class="n">temp</span><span class="o">/</span><span class="n">shit</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>3 如何对文件和目录进行操作呢？

<ul>
<li>file fileName： 显示指定file的信息</li>
<li>touch fileName：更新指定文件的时间，或新建空文件</li>
<li>cp path1 path2：将path1的文件复制到path2</li>
<li>rm fileName：删除指定文件</li>
<li>mv：移动指定文件（类似cp），或重命名文件</li>
<li>find：查找文件，如：find ./logs/ -name &lsquo;error*' 表示在logs目录下查找名称以error开头的文件</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">file</span> <span class="n">a</span>
</span><span class='line'><span class="nl">a</span><span class="p">:</span> <span class="n">ASCII</span> <span class="n">text</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">cp</span> <span class="n">a</span> <span class="n">a</span><span class="o">-</span><span class="n">bak</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ls</span>
</span><span class='line'><span class="n">a</span>  <span class="n">a</span><span class="o">-</span><span class="n">bak</span>  <span class="n">b</span>  <span class="n">c</span>  <span class="n">d</span>  <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">mv</span> <span class="n">a</span> <span class="n">a</span><span class="o">-</span><span class="n">origin</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ls</span>
</span><span class='line'><span class="n">a</span><span class="o">-</span><span class="n">bak</span>  <span class="n">a</span><span class="o">-</span><span class="n">origin</span>  <span class="n">b</span>  <span class="n">c</span>  <span class="n">d</span>  <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">find</span>  <span class="n">a</span><span class="o">*</span>
</span><span class='line'><span class="n">a</span><span class="o">-</span><span class="n">bak</span>
</span><span class='line'><span class="n">a</span><span class="o">-</span><span class="n">origin</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">rm</span> <span class="n">a</span><span class="o">-</span><span class="n">bak</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ls</span>
</span><span class='line'><span class="n">a</span><span class="o">-</span><span class="n">origin</span>  <span class="n">b</span>  <span class="n">c</span>  <span class="n">d</span>  <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>4 如何文本文件？

<ul>
<li>cat fileName：显示指定文件的全部内容</li>
<li>more：分页显示指定文件</li>
<li>less：分页显示指定文件</li>
<li>head：显示指定文件头部的信息</li>
<li>tail：显示指定文件尾部的信息</li>
</ul>
</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">cat</span> <span class="n">a</span><span class="o">-</span><span class="n">origin</span>
</span><span class='line'><span class="n">aaaaa</span>
</span><span class='line'><span class="mi">2</span>
</span></code></pre></td></tr></table></div></figure>


<p></p>

<ul>
<li>5 命令使用技巧[2]</li>
</ul>


<p> 在终端输入命令，按回车执行
 - 命令可用tab键自动进行补齐
 - 一般可使用-h、-help或&ndash;help参数查看命令 的说明以及该命令可用的参数
 - 使用man(manual)命令也可查看其它命令的 说明以及其可用的参数   <br/>
  - 格式：man 其它命令</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">man</span> <span class="n">cat</span>
</span></code></pre></td></tr></table></div></figure>


<p> 包括前面用到的几个命令在内，Linux命令可以分类如下：
 - 浏览目录命令:ls  pwd  cd
 - 浏览文件命令:ls  cat  more  less  head  tail
 - 目录操作命令:chmod  mkdir  rm  mv  cp  find
 - 文件操作命令:chmod  vi  rm  mv  cp  ln  find  grep  tar  gzip</p>

<h1>如何编辑文件？——vim编辑器入门</h1>

<p>vim编辑器是需要CentOS自带的vi编辑器的加强版，需要下载：<code># yum install vim</code>.<br/>
这里简单举两个栗子：
- 1 新建文件hello.txt，输入内容，保存并退出
  - <code>$ vim hello.txt</code>
  - 按i键进入编辑模式，输入三行内容
  - 按ESC键进入命令模式，输入<code>:wq</code>，保存并退出
- 2 编辑hello.txt，删除第一行，复制第二行到尾部</p>

<p><img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-27/72770552.jpg" alt="" /></p>

<p>试着操作之后会对命令模式与插入模式有直观的了解。</p>

<h1>用户管理</h1>

<ul>
<li>1 借助GUI新建用户<code>test0</code></li>
</ul>


<p><img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-27/28596222.jpg" alt="" /><br/>
查看该用户的home目录：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">ll</span> <span class="o">-</span><span class="n">a</span> <span class="n">test0</span><span class="o">/</span>
</span><span class='line'><span class="n">total</span> <span class="mi">32</span>
</span><span class='line'><span class="n">drwx</span><span class="o">------</span><span class="p">.</span> <span class="mi">4</span> <span class="n">test0</span> <span class="n">test0</span> <span class="mi">4096</span> <span class="n">Mar</span>  <span class="mi">6</span> <span class="mi">19</span><span class="o">:</span><span class="mi">44</span> <span class="p">.</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">4</span> <span class="n">root</span>  <span class="n">root</span>  <span class="mi">4096</span> <span class="n">Mar</span>  <span class="mi">6</span> <span class="mi">19</span><span class="o">:</span><span class="mi">44</span> <span class="p">..</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test0</span> <span class="n">test0</span>   <span class="mi">18</span> <span class="n">Jul</span> <span class="mi">24</span>  <span class="mi">2015</span> <span class="p">.</span><span class="n">bash_logout</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test0</span> <span class="n">test0</span>  <span class="mi">176</span> <span class="n">Jul</span> <span class="mi">24</span>  <span class="mi">2015</span> <span class="p">.</span><span class="n">bash_profile</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test0</span> <span class="n">test0</span>  <span class="mi">124</span> <span class="n">Jul</span> <span class="mi">24</span>  <span class="mi">2015</span> <span class="p">.</span><span class="n">bashrc</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test0</span> <span class="n">test0</span>  <span class="mi">500</span> <span class="n">Nov</span> <span class="mi">27</span>  <span class="mi">2014</span> <span class="p">.</span><span class="n">emacs</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">2</span> <span class="n">test0</span> <span class="n">test0</span> <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">12</span>  <span class="mi">2010</span> <span class="p">.</span><span class="n">gnome2</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">4</span> <span class="n">test0</span> <span class="n">test0</span> <span class="mi">4096</span> <span class="n">Mar</span>  <span class="mi">6</span> <span class="mi">17</span><span class="o">:</span><span class="mo">00</span> <span class="p">.</span><span class="n">mozilla</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>2 用<code>useradd</code>新建用户<code>test1</code>，并添加密码</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">useradd</span> <span class="n">test1</span>
</span><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">passwd</span> <span class="n">test1</span>
</span><span class='line'><span class="n">Changing</span> <span class="n">password</span> <span class="k">for</span> <span class="n">user</span> <span class="n">test1</span><span class="p">.</span>
</span><span class='line'><span class="n">New</span> <span class="nl">password</span><span class="p">:</span>
</span><span class='line'><span class="n">BAD</span> <span class="nl">PASSWORD</span><span class="p">:</span> <span class="n">it</span> <span class="n">is</span> <span class="n">WAY</span> <span class="n">too</span> <span class="kt">short</span>
</span><span class='line'><span class="n">BAD</span> <span class="nl">PASSWORD</span><span class="p">:</span> <span class="n">is</span> <span class="n">a</span> <span class="n">palindrome</span>
</span><span class='line'><span class="n">Retype</span> <span class="n">new</span> <span class="nl">password</span><span class="p">:</span>
</span><span class='line'><span class="nl">passwd</span><span class="p">:</span> <span class="n">all</span> <span class="n">authentication</span> <span class="n">tokens</span> <span class="n">updated</span> <span class="n">successfully</span><span class="p">.</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">ll</span> <span class="o">-</span><span class="n">a</span> <span class="n">test1</span><span class="o">/</span>
</span><span class='line'><span class="n">total</span> <span class="mi">32</span>
</span><span class='line'><span class="n">drwx</span><span class="o">------</span><span class="p">.</span> <span class="mi">4</span> <span class="n">test1</span> <span class="n">test1</span> <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">11</span><span class="o">:</span><span class="mi">41</span> <span class="p">.</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">5</span> <span class="n">root</span>  <span class="n">root</span>  <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">11</span><span class="o">:</span><span class="mi">41</span> <span class="p">..</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test1</span> <span class="n">test1</span>   <span class="mi">18</span> <span class="n">Jul</span> <span class="mi">24</span>  <span class="mi">2015</span> <span class="p">.</span><span class="n">bash_logout</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test1</span> <span class="n">test1</span>  <span class="mi">176</span> <span class="n">Jul</span> <span class="mi">24</span>  <span class="mi">2015</span> <span class="p">.</span><span class="n">bash_profile</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test1</span> <span class="n">test1</span>  <span class="mi">124</span> <span class="n">Jul</span> <span class="mi">24</span>  <span class="mi">2015</span> <span class="p">.</span><span class="n">bashrc</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">test1</span> <span class="n">test1</span>  <span class="mi">500</span> <span class="n">Nov</span> <span class="mi">27</span>  <span class="mi">2014</span> <span class="p">.</span><span class="n">emacs</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">2</span> <span class="n">test1</span> <span class="n">test1</span> <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">12</span>  <span class="mi">2010</span> <span class="p">.</span><span class="n">gnome2</span>
</span><span class='line'><span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span><span class="p">.</span> <span class="mi">4</span> <span class="n">test1</span> <span class="n">test1</span> <span class="mi">4096</span> <span class="n">Mar</span>  <span class="mi">6</span> <span class="mi">17</span><span class="o">:</span><span class="mo">00</span> <span class="p">.</span><span class="n">mozilla</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>3 切换用户</li>
</ul>


<p>test0&ndash;>test1&ndash;>root</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">test0</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">$</span> <span class="n">su</span> <span class="n">test1</span>
</span><span class='line'><span class="nl">Password</span><span class="p">:</span>
</span><span class='line'><span class="p">[</span><span class="n">test1</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">$</span>
</span><span class='line'>
</span><span class='line'><span class="p">[</span><span class="n">test1</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">$</span> <span class="n">su</span>
</span><span class='line'><span class="nl">Password</span><span class="p">:</span>
</span><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>4 删除用户</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">userdel</span> <span class="n">test1</span>
</span><span class='line'><span class="nl">userdel</span><span class="p">:</span> <span class="n">user</span> <span class="n">test1</span> <span class="n">is</span> <span class="n">currently</span> <span class="n">used</span> <span class="n">by</span> <span class="n">process</span> <span class="mi">3087</span>
</span></code></pre></td></tr></table></div></figure>


<p>删除失败，接着参数<code>rf</code>，强制删除</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">userdel</span> <span class="o">-</span><span class="n">rf</span> <span class="n">test1</span>
</span><span class='line'><span class="nl">userdel</span><span class="p">:</span> <span class="n">user</span> <span class="n">test1</span> <span class="n">is</span> <span class="n">currently</span> <span class="n">used</span> <span class="n">by</span> <span class="n">process</span> <span class="mi">3087</span>
</span></code></pre></td></tr></table></div></figure>


<p>虽然依然提示test1正在被使用，但是删除成功了。其中r表示删除该用户的home文件夹，f表示强制删除。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">root</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">home</span><span class="p">]</span><span class="err">#</span> <span class="n">userdel</span> <span class="o">-</span><span class="n">h</span>
</span><span class='line'><span class="nl">Usage</span><span class="p">:</span> <span class="n">userdel</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="n">LOGIN</span>
</span><span class='line'>
</span><span class='line'><span class="nl">Options</span><span class="p">:</span>
</span><span class='line'>  <span class="o">-</span><span class="n">f</span><span class="p">,</span> <span class="o">--</span><span class="n">force</span>                   <span class="n">force</span> <span class="n">removal</span> <span class="n">of</span> <span class="n">files</span><span class="p">,</span>
</span><span class='line'>                                <span class="n">even</span> <span class="k">if</span> <span class="n">not</span> <span class="n">owned</span> <span class="n">by</span> <span class="n">user</span>
</span><span class='line'>  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>                    <span class="n">display</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="n">and</span> <span class="n">exit</span>
</span><span class='line'>  <span class="o">-</span><span class="n">r</span><span class="p">,</span> <span class="o">--</span><span class="n">remove</span>                  <span class="n">remove</span> <span class="n">home</span> <span class="n">directory</span> <span class="n">and</span> <span class="n">mail</span> <span class="n">spool</span>
</span><span class='line'>  <span class="o">-</span><span class="n">Z</span><span class="p">,</span> <span class="o">--</span><span class="n">selinux</span><span class="o">-</span><span class="n">user</span>            <span class="n">remove</span> <span class="n">SELinux</span> <span class="n">user</span> <span class="n">from</span> <span class="n">SELinux</span> <span class="n">user</span> <span class="n">mapping</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>拾遗</li>
</ul>


<p>Linux下有三类用户，超级用户(root)具有操作系统的一切权限，UID值均为0。普通用户具有操作系统有限的权限，只能管理自己启动的进程，UID值500~6000。系统用户是为了方便系统管理，满足相应的系统进程对文件属主的的要求，系统用户不能登录，UID值1~499。</p>

<p>这里新建普通用户的UID会依次增长，fsj为500，test0为501，test1为502</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="err">$</span> <span class="n">id</span> <span class="n">fsj</span>
</span><span class='line'><span class="n">uid</span><span class="o">=</span><span class="mi">500</span><span class="p">(</span><span class="n">fsj</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">500</span><span class="p">(</span><span class="n">fsj</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">500</span><span class="p">(</span><span class="n">fsj</span><span class="p">)</span>
</span><span class='line'><span class="err">$</span> <span class="n">id</span> <span class="n">test0</span>
</span><span class='line'><span class="n">uid</span><span class="o">=</span><span class="mi">501</span><span class="p">(</span><span class="n">test0</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">501</span><span class="p">(</span><span class="n">test0</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">501</span><span class="p">(</span><span class="n">test0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<h1>文件/目录权限管理</h1>

<ul>
<li>1 文件详情中有权限信息</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ll</span>
</span><span class='line'><span class="n">total</span> <span class="mi">0</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">touch</span> <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ll</span>
</span><span class='line'><span class="n">total</span> <span class="mi">0</span>
</span><span class='line'><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">13</span><span class="o">:</span><span class="mi">10</span> <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span></code></pre></td></tr></table></div></figure>


<p>其中第一列<code>-rw-rw-r--</code>表示当前文件权限，其他列see also：[4].<br/>
这一列的第一个字符表示文件类型。取值包括：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">d</span> <span class="err">：目录</span>
</span><span class='line'><span class="o">-</span> <span class="err">：文件</span>
</span><span class='line'><span class="n">l</span> <span class="err">：链接</span>
</span><span class='line'><span class="n">s</span> <span class="err">：</span><span class="n">socket</span>
</span><span class='line'><span class="n">p</span> <span class="err">：</span><span class="n">named</span> <span class="n">pipe</span>
</span><span class='line'><span class="n">b</span> <span class="err">：</span><span class="n">block</span> <span class="n">device</span>
</span><span class='line'><span class="n">c</span>  <span class="err">：</span><span class="n">character</span> <span class="n">device</span>
</span></code></pre></td></tr></table></div></figure>


<p>剩下9位，3为一组。格式为：[属主权限][属组用户权限][其他用户权限]</p>

<p>属主和属组用户为<code>rw-</code>，有读、写权限。<br/>
其他用户为<code>r--</code>，有读权限。</p>

<ul>
<li>2 用chmod设置文件权限</li>
</ul>


<p>把前面shit.c权限改为只允许属主读写执行(rwx)，其他用户只能读&reg;.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">chmod</span> <span class="mi">744</span> <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="n">shit</span><span class="p">]</span><span class="err">$</span> <span class="n">ll</span>
</span><span class='line'><span class="n">total</span> <span class="mi">0</span>
</span><span class='line'><span class="o">-</span><span class="n">rwxr</span><span class="o">--</span><span class="n">r</span><span class="o">--</span><span class="p">.</span> <span class="mi">1</span> <span class="n">fsj</span> <span class="n">fsj</span> <span class="mi">0</span> <span class="n">Mar</span> <span class="mi">27</span> <span class="mi">13</span><span class="o">:</span><span class="mi">10</span> <span class="n">shit</span><span class="p">.</span><span class="n">c</span>
</span></code></pre></td></tr></table></div></figure>


<p>744什么和rwx对应起来的呢？</p>

<p>我们用二进制来表示是否允许某个权限，允许就置1，不允许就置0，比如777表示所有用户都有读、写、执行权限。
7<code>7</code>7（8进制）=111<code>111</code>111（2进制），9位都置一，就是所有权限都开。<br/>
这里7<code>4</code>4（8进制）=111<code>100</code>100（2进制），属主读写执行(rwx)，其他用户只能读&reg;.</p>

<p>换算的时候rwx权重分别看作421那就简单了，比如<code>rw-</code>就是<code>110</code>，也是<code>6</code>.</p>

<p>修改权限有什么用呢？当你搞一些配置文件的时候会想起来的~</p>

<h1>ref</h1>

<ul>
<li>[1] <a href="http://linuxtools-rst.readthedocs.org/zh_CN/latest/index.html">linux工具快速教程</a></li>
<li>[2] Linux入门——郭桂鑫</li>
<li>[3] <a href="http://www.2cto.com/os/201408/328936.html">Linux中添加用户、删除用户时新手可能遇到的问题</a></li>
<li>[4] <a href="http://blog.csdn.net/jenminzhang/article/details/9816853"> Linux &ldquo;ls -l"文件列表权限详解</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux服务器配置和管理：虚拟机安装CentOS6.7]]></title>
    <link href="http://lawlietfans.coding.me/blog/2016/02/29/introduction-and-centos67-install/"/>
    <updated>2016-02-29T20:00:00+08:00</updated>
    <id>http://lawlietfans.coding.me/blog/2016/02/29/introduction-and-centos67-install</id>
    <content type="html"><![CDATA[<blockquote><p>原文地址：<a href="http://lawlietfans.coding.me/blog/2016/02/29/introduction-and-centos67-install/">http://lawlietfans.coding.me/blog/2016/02/29/introduction-and-centos67-install/</a></p></blockquote>

<p>相比于在PC端的流行的Windows，多数服务器使用的则是Linux系统。对于刚刚进入IT领域的“菜鸟”而言，学习和掌握Linux服务器配置与管理是非常有意义的。学windows，天天跟着时尚跑，今天DNA，明天COM，后天.NET; 而Unix/Linux，几十年前的思想今天看来依然光彩夺目。（<a href="http://www.zhihu.com/question/19771396">学习 Linux 有哪些好处？</a>)。</p>

<p>本系列教程全部都是基于vmware 11.1+ centos 6.7 i386的，宿主机为Windows7 x64操作系统。<br/>
本文内容包括：发展史；自由软件文化；Linux系统的优势；安装使用。</p>

<!-- more -->


<p>CentOS是Community ENTerprise Operating System的简称，是Linux的一个发行版本。发行版其实就是一些整合的安装套件，它是由一些有系统整合能力的工作小组、机构或商业化公司等主动搜集并整合了网络上的部分Linux程序，把系统内核、附带的工具程序以及应用软件包等打包在一起，组成的一个Linux操作系统的集合体。安装者可以一次安装一个包括各种程序在内的完整系统，极大地提高了系统的安装效率。</p>

<p>其中RHEL(Red Hat Enterprise Linux)是很多企业采用的linux发行版本，需要向RedHat付费才可以使用，并能得到付过费用的服务和技术支持和版本升级。CentOS是RHEL的克隆版本，可以像REHL一样的构筑linux系统环境，但不需要向RedHat付任何的费用，同样也得不到任何有偿技术支持和升级服务。</p>

<h1>Linux发展史；自由软件文化；Linux系统的优势</h1>

<p>对new beginner来说，这部分没什么意义，网上内容很多，你懂的。</p>

<h1>0 安装前准备</h1>

<ul>
<li>vmware虚拟机</li>
<li><a href="http://mirrors.163.com/centos/6.7/isos/i386/">centos6.7 iso文件</a>

<ul>
<li>只需要下载CentOS-6.7-i386-bin-DVD1.iso就可以了。</li>
<li>DVD1已经包含了完整的base distribution，不需要下载DVD2</li>
</ul>
</li>
</ul>


<h1>1 安装流程</h1>

<p>参考[1]即可，流程如下：</p>

<ul>
<li>创建虚拟机vm-centos（我这里测试用机磁盘大小填的40GB）</li>
<li>设置centos，添加系统镜像文件</li>
<li>启动虚拟机，进入安装步骤</li>
</ul>


<p>其中在在分区这一步，直接选择Use All Space比较简单，centos会默认分区。</p>

<p><img src="http://www.linuxdown.net/uploads/allimg/150823/02055WV8-25.jpg" alt="" /></p>

<p>我这里选择的自定义虚拟分区，划分<code>/boot</code>分区为300M，剩余的为LVM，具体如下：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="o">/</span><span class="n">boot</span>  <span class="mi">300</span><span class="n">M</span>
</span><span class='line'><span class="o">/</span><span class="n">LVM</span>
</span><span class='line'>  <span class="o">/</span> <span class="mi">20</span><span class="n">G</span>
</span><span class='line'>  <span class="o">/</span><span class="n">var</span> <span class="p">(</span><span class="err">余下全部</span><span class="p">)</span>
</span><span class='line'>  <span class="o">/</span><span class="n">swap</span><span class="p">(</span><span class="err">自己内存大小</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>这里为什么要用LVM？ LVM：逻辑卷管理，把硬盘、分区作为物理卷PV，建立卷组VG，VG上建逻辑卷LV，再做成文件系统、裸设备，优点是可扩展性强<br/>
标准分区：就是硬盘分区，可以做裸设备，或建文件系统，受硬盘大小限制，可扩展性差</p></blockquote>

<ul>
<li>安装完成</li>
</ul>


<h1>2 更新系统</h1>

<ul>
<li>打开terminal，输入<code>sudo yum update</code></li>
</ul>


<blockquote><p>在linux系统中，普通用户可以通过sudo 命令以super user 身份执行指令，只要输入该用户的密码即可。</p></blockquote>

<p>如果登陆系统后执行sudo 命令提示<code>该用户不存在与群组sudoers中</code>，那么你需要<a href="http://www.centoscn.com/CentOS/2015/0417/5200.html">把用户添加到sudo列表中</a></p>

<ul>
<li>修改<code>/etc/sudoers</code>即可</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">root</span>  <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">ALL</span><span class="p">)</span>   <span class="n">ALL</span>    <span class="err">#</span> <span class="err">后面换行并将当前用户添加进去</span>
</span><span class='line'><span class="n">xxx</span>   <span class="n">ALL</span><span class="o">=</span><span class="p">(</span><span class="n">ALL</span><span class="p">)</span>   <span class="n">ALL</span><span class="p">;</span>    <span class="err">#</span> <span class="n">xxx</span><span class="err">改成你的用户名</span>
</span></code></pre></td></tr></table></div></figure>


<h1>3 设置开机自动联网</h1>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="p">[</span><span class="n">fsj</span><span class="err">@</span><span class="n">vm</span><span class="o">-</span><span class="n">centos</span> <span class="o">~</span><span class="p">]</span><span class="err">$</span> <span class="n">sudo</span> <span class="n">vi</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sysconfig</span><span class="o">/</span><span class="n">network</span><span class="o">-</span><span class="n">scripts</span><span class="o">/</span><span class="n">ifcfg</span><span class="o">-</span><span class="n">eth0</span>
</span><span class='line'>
</span><span class='line'><span class="err">把</span><span class="n">ONBOOT</span><span class="o">=</span><span class="s">&quot;no&quot;</span><span class="err">改为</span><span class="n">yes</span>
</span></code></pre></td></tr></table></div></figure>


<blockquote><p>控制台上<code>[fsj@vm-centos ~]$</code>的通用格式为<code>[用户名@机器名称 当前路径]提示符</code>，其中提示符为$表示普通权限，后面以<code>$</code>开头的语句都是要在控制台输入的命令</p></blockquote>

<h1>4 安装OpenSSH Server</h1>

<p>方便宿主机的xshell连接刚装好的虚拟机<code>vm-centos</code></p>

<ul>
<li>$ yum search ssh</li>
<li>$ yum install openssh-server</li>
<li>检查该服务开机启动：chkconfig &ndash;list sshd</li>
<li>手动启动sshd服务:<code>/etc/init.d/sshd start</code></li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="err">$</span> <span class="n">chkconfig</span> <span class="o">--</span><span class="n">list</span> <span class="n">sshd</span>
</span><span class='line'><span class="n">sshd</span>            <span class="mi">0</span><span class="o">:</span><span class="n">off</span> <span class="mi">1</span><span class="o">:</span><span class="n">off</span> <span class="mi">2</span><span class="o">:</span><span class="n">on</span>  <span class="mi">3</span><span class="o">:</span><span class="n">on</span>  <span class="mi">4</span><span class="o">:</span><span class="n">on</span>  <span class="mi">5</span><span class="o">:</span><span class="n">on</span>  <span class="mi">6</span><span class="o">:</span><span class="n">off</span>
</span></code></pre></td></tr></table></div></figure>


<p>2~5都是on，就表明会自动启动</p>

<h1>5 通过xshell连接<code>vm-centos</code></h1>

<p>安装好openssh之后就能在宿主机连接<code>vm-centos</code>了。</p>

<p>获取<code>vm-centos</code>地址</p>

<p><img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-18/64469253.jpg" alt="" />
<img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-18/84107400.jpg" alt="" /></p>

<p>打开xshell，新建连接</p>

<p><img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-18/40913349.jpg" alt="" />
<img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-18/6379138.jpg" alt="" /></p>

<p>连接成功</p>

<p><img src="http://7xo0zf.com1.z0.glb.clouddn.com/16-3-18/93379079.jpg" alt="" /></p>

<h1>ref</h1>

<ul>
<li>[1] <a href="http://www.centoscn.com/image-text/setup/2015/0823/6047.html">虚拟机下安装CentOS 6.7系统教程</a></li>
<li>[2] <a href="http://www.linuxidc.com/Linux/2011-07/39098.htm">http://www.linuxidc.com/Linux/2011-07/39098.htm</a></li>
<li>[3] <a href="http://www.zhihu.com/question/19738282">Linux 作为服务器操作系统的优势是什么？</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[基于github Pages与hexo搭建一个独立博客]]></title>
    <link href="http://lawlietfans.coding.me/blog/2015/11/09/using-hexo-with-jekyll/"/>
    <updated>2015-11-09T01:08:22+08:00</updated>
    <id>http://lawlietfans.coding.me/blog/2015/11/09/using-hexo-with-jekyll</id>
    <content type="html"><![CDATA[<blockquote><p>原文地址：<a href="http://lawlietfans.coding.me/blog/2015/11/08/using-hexo-with-jekyll/">http://lawlietfans.coding.me/blog/2015/11/08/using-hexo-with-jekyll/</a><br/>
2015-11-15 theme update<br/>
原文备份到：<a href="http://lawlietfans.github.io/project-site-blogs/2015/11/08/using-hexo-with-jekyll/">http://lawlietfans.github.io/project-site-blogs/2015/11/08/using-hexo-with-jekyll/</a></p></blockquote>

<p>介绍基于github pages搭建独立博客的博文已经有很多了，而本文旨在帮助读者了解基于github pages与hexo搭建一个独立博客的整体过程，顺便备忘。</p>

<!-- more -->


<p>在开始动手操作之前，我们应该了解什么是github page？为什么要用hexo？
<a href="http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html" title="搭建一个免费的，无限流量的Blog----github Pages和Jekyll入门">github Pages可以被认为是用户编写的、托管在github上的静态网页</a>,GitHub Pages分两种，一种是你的GitHub用户名建立的username.github.io这样的用户&amp;组织页（站），另一种是依附项目的pages。
即<a href="https://pages.github.com/">organization site和project site</a>.<br/>
不过官方目前不建议用二级域名，我们这里的例子也是属于organization site.</p>

<p>至于hexo，快速、简洁且高效的博客框架，文档完善，主题丰富</p>

<h1>1 配置organization site</h1>

<p> 新增仓库：<a href="https://github.com/new">https://github.com/new</a></p>

<pre><code>  Repository name：github账号.github.io
  Description：随便输入点描述
  public
  Initialize this repository with a README
  .gitignore 选择初始的文件忽略，我选的java
  Licenses：我选的NPL（GNU General Public License v2.0）
  配置
</code></pre>

<p>选择右侧操作区的settings</p>

<pre><code>  选择Launch automatic page generator
  输入一些基本说明，非必要
  选择Load README.md
  继续Continue to layouts
  选择模板（随便选个）
  发布Publish page
  此时进入settings应该会有Your site is published at http://username.github.io的条提示，访问一下，神奇吧！
  如果404，请检查你的仓库名或账号名，删除仓库重来，删除也是在settings最底部
</code></pre>

<p><a href="http://liuxing.info/2015/06/14/GitHub%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/#%E9%85%8D%E7%BD%AEPages" title="配置pages">参考-详细</a></p>

<h1>2 本地准备工作</h1>

<p><a href="http://git-scm.com/download/">安装git</a><br/>
安装Node.JS</p>

<pre><code>安装完成后添加Path环境变量，使npm命令生效。新版已经会自动配置Path  
;C:\Program Files\nodejs\node_modules\npm
</code></pre>

<p>安装Hexo</p>

<pre><code>npm install hexo-cli -g
npm install hexo --save

#如果命令无法运行，可以尝试更换taobao的npm源
npm install -g cnpm --registry=https://registry.npm.taobao.org
#新建文件夹&lt;folder&gt;
cd &lt;folder&gt;
hexo init 
npm install
</code></pre>

<p>运行</p>

<pre><code>$ hexo g
$ hexo s
</code></pre>

<p>Git Bush或者Linux环境下terminal会提示输入<a href="http://0.0.0.0:4000">http://0.0.0.0:4000</a>  查看自带landspace主题效果</p>

<p><a href="http://wsgzao.github.io/post/hexo-guide/" title="使用GitHub和Hexo搭建免费静态Blog">参考-详细</a></p>

<h1>3 如何使用新主题，以<a href="http://pinggod.com/">Jekyll主题</a>为例</h1>

<p><a href="https://hexo.io/themes/" title="more themes">hexo提供的更多主题</a>提供了丰富的主题可以选择，安装方法大同小异，其中包括一款黑色背景的，好了，就它了。</p>

<p>安装插件</p>

<pre><code>npm install --save hexo-renderer-jade hexo-generator-feed
</code></pre>

<p>clone该主题到<code>&lt;folder&gt;/themes/jekyll</code>文件夹</p>

<pre><code>git clone https://github.com/pinggod/hexo-theme-jekyll.git themes/jekyll
</code></pre>

<p>修改<folder>/_config.yml的theme值</p>

<p>添加feed属性</p>

<p>复制Demo.md到source/_post文件夹</p>

<p>本地运行预览</p>

<p>配置<a href="http://hexo.io/docs/deployment.html">deploy属性</a></p>

<pre><code>deploy:
  type: git
  repository: 前面步骤在github建好的Repository的地址
  branch: master
</code></pre>

<p>发布到远程</p>

<pre><code>hexo d
</code></pre>

<p>最后就可以在yourname.github.io看到效果了</p>

<p>个人觉得不错的其他主题：
- <a href="http://jukezhang.com/2014/11/01/construct-blog-with-hexo&amp;&amp;gitcafe/#%E5%AE%89%E8%A3%85Jacman%E4%B8%BB%E9%A2%98%EF%BC%9A" title="jacman主题">jacman</a>  <br/>
- <a href="http://yangjian.me/workspace/introducing-pacman-theme/" title="pacman主题">pacman</a></p>

<p>常用命令总结</p>

<pre><code>hexo new "postName" # 新建文章
hexo new page "about" # 新建页面
hexo generate #生成静态页面至public目录
hexo server #开启预览访问端口（默认端口4000，'ctrl + c'关闭server）
hexo deploy #将.deploy目录部署到GitHub
hexo clean # 有时候配置没有立即生效需要删除cache
</code></pre>

<h1>4 修改这个主题</h1>

<h2>4.1 添加新文章</h2>

<pre><code>$ hexo new [layout] &lt;title&gt;
</code></pre>

<p>Layout包括：post、page 和 draft</p>

<p>Hexo 默认以标题做为文件名称<code>:title.md</code>：</p>

<pre><code>$ hexo new test-2249
INFO  Created: e:\workspace\github\blog-github\source\_posts\test-2249.md
</code></pre>

<p>如果设为<code>:year-:month-:day-:title.md</code></p>

<pre><code>$ hexo new test-2247
INFO  Created: e:\workspace\github\blog-github\source\_posts\2015-11-07-test-224
7.md 
</code></pre>

<p>两者都自动生成title和date，但是后者更便于管理。</p>

<h2>4.2 修改主页</h2>

<p>首先对比主页<code>&lt;foldername&gt;/themes/jekyll/layout/index.jade</code>:</p>

<pre><code>extends _partial/layout

block content
    include _mixin/post
    +homePost()

block extra
    include _components/project
    include _components/selfintro
</code></pre>

<p>和归档页<code>&lt;foldername&gt;/themes/jekyll/layout/archive.jade</code>:</p>

<pre><code>extends _partial/layout

    block content
        include _mixin/post
        +archivePost()
        aside.sidebar
            include _sidebar/tag
            include _sidebar/post            
</code></pre>

<p>删掉index.jade中<code>include _components/project</code>这句就比较精简了。          <br/>
主页样式变成<code>一篇新文章+个人介绍</code>，直接修改jekyll/_config.yml下<code>selfIntro:</code>部分并不能令人满意，这里直接修改<code>/layout/_components/selfintro.jade</code></p>

<pre><code>section.selfintro
    .wrap.row-flex.row-flex-row.limit-width
        .sign
            img(src="img/github.png", alt="")
        .intro
            if theme.selfIntro.title
                h3.title
                    != theme.selfIntro.title
            else 
                h3.title 超爽der
            if theme.selfIntro.content
                p.content 
                    != theme.selfIntro.content
            else 
                p.content 空空

            // 默认的href都为空，填上链接
            ul.contact
                li 
                    a(href="https://github.com/lawlietfans") GitHub
                li
                    a(href="http://weibo.com/lawlietfans") Weibo
</code></pre>

<p>接着再找一个合适的logo替换github.png就可以了（不用也行。。），logo背景透明才能和主题融合</p>

<p>see more: <a href="http://naltatis.github.io/jade-syntax-docs/">Jade Syntax Documentatio</a></p>

<pre><code>Comments
// single line comment
//- invisible single line comment
</code></pre>

<h2>4.3 修改头部导航</h2>

<p>从这里<code>/layout/_components/nav.jade</code>添加修改menu</p>

<pre><code>    nav
        ul.nav-list
            li.nav-list-item
                a.nav-link(href= theme.menu['home'] class=is_home() ? 'active' : '')
                    = __('index.title')
            li.nav-list-item
                a.nav-link(href= theme.menu['blog'] class= is_archive() || is_post() ? 'active' : '')    
                    = __('archive.title')
            li.nav-list-item
                a.nav-link(href= theme.menu['rss'])
                    = __('rss.title')
            //li.nav-list-item
            //    a.nav-link(href= theme.menu['github'] target="_blank")    
            //        = __('github.title')
</code></pre>

<p>依个人口味酌情修改即可。除此之外，RSS插件<a href="http://wsgzao.github.io/post/hexo-guide/" title="使用GitHub和Hexo搭建免费静态Blog">安装之后</a>本地预览是没效果的，一般部署之后过段时间才有效</p>

<h2>4.4 侧边栏</h2>

<p><code>layout/_sidebar/</code>包含post.jade、tag.jade、和toc.jade三个部件，理论上都可以添加到archive.jade</p>

<pre><code>extends _partial/layout

block content
    include _mixin/post
    +archivePost()
    aside.sidebar
        include _sidebar/tag
        include _sidebar/post
</code></pre>

<p>但是添加<code>include _sidebar/toc</code>之后会报错如下：</p>

<pre><code>Unhandled rejection TypeError: e:\workspace\github\blog-github\themes\jekyll\lay
out\_sidebar\toc.jade:1
  &gt; 1| if toc(page.content, {list_number: false})
    2|   h3 文章目录
    3|   != list_tags({amount: 5, show_count: false})
    4|            
</code></pre>

<p>有待牛人解决</p>

<h2>4.5 最后如果使用这个主题有兴趣和问题可以到<a href="https://github.com/pinggod/hexo-theme-jekyll/issues">这里</a>多多交流</h2>
]]></content>
  </entry>
  
</feed>
